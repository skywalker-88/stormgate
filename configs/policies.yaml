server:
  addr: ":8080"

redis:
  addr: "redis:6379"   # use "redis:6379" when running via docker-compose
  db: 0
  password: ""

identity:
  # one of: header:<Header-Name> | ip
  source: "header:X-API-Key"

limits:
  default:
    rps: 20
    burst: 40
    cost: 1
  routes:
    "/read":
      rps: 50
      burst: 100
      cost: 1
    "/search":
      rps: 10
      burst: 20
      cost: 5

anomaly:
  enabled: true
  window_seconds: 10
  buckets: 10
  threshold_multiplier: 2.0
  ewma_alpha: 0.2
  ttl_seconds: 300 # evict keys idle > 5m
  evict_every_seconds: 30 # run janitor every 30s
  keep_suspicious_seconds: 600 # keep suspicious keys for 10m

